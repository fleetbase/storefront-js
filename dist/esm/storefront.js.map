{"version":3,"file":"storefront.js","sources":["../../src/utils/detect-adapter.js","../../src/resources/network.js","../../src/storefront.js","../../src/utils/is-key-valid.js"],"sourcesContent":["import { lookup } from '../resolver';\nimport { isNodeEnvironment } from '@fleetbase/sdk';\n\nconst detectAdapter = (options = {}) => {\n    if (isNodeEnvironment()) {\n        return lookup('adapter', 'NodeAdapter', options);\n    }\n\n    return lookup('adapter', 'BrowserAdapter', options);\n};\n\nexport default detectAdapter;\n","import { Collection } from '@fleetbase/sdk';\nimport Resource from '../resource';\nimport PaymentGateway from './payment-gateway';\nimport Store from './store';\nimport StoreLocation from './store-location';\n\nexport default class Network extends Resource {\n    constructor(attributes = {}, adapter, options = {}) {\n        super(attributes, adapter, 'network', options);\n    }\n\n    getTags(params = {}) {\n        return this.adapter.get('tags', params);\n    }\n\n    async getResourceCollection(endpoint, ResourceClass, params = {}) {\n        try {\n            const resources = await this.adapter.get(endpoint, params);\n            return new Collection(resources.map((attributes) => new ResourceClass(attributes, this.adapter)));\n        } catch (error) {\n            console.error(`Error fetching ${endpoint}:`, error);\n            throw error;\n        }\n    }\n\n    async getStores(params = {}) {\n        return this.getResourceCollection('stores', Store, params);\n    }\n\n    async getStoreLocations(params = {}) {\n        return this.getResourceCollection('store-locations', StoreLocation, params);\n    }\n\n    async getPaymentGateways() {\n        return this.getResourceCollection('gateways', PaymentGateway);\n    }\n}\n","import StorefrontStore from './store';\nimport { detectAdapter, isKeyValid } from './utils';\nimport { lookup } from './resolver';\nimport { Product, Category, Customer, Cart, Store, StoreLocation, StoreHour, DeliveryServiceQuote, Checkout, PaymentGateway, Review, Network } from './resources';\nimport { cartActions } from './resources/cart';\nimport { customerActions } from './resources/customer';\nimport { checkoutActions } from './resources/checkout';\nimport { reviewActions } from './resources/review';\nimport { Collection } from '@fleetbase/sdk';\n\n/**\n * // instance\n * const storefront = new Storefront();\n *\n */\n\nexport default class Storefront {\n    /**\n     * Builds an instance of the Fleetbase Storefront SDK\n     *\n     * @param  {String} storeKey  The access key for the storefront store\n     * @param  {Object} config    The config object\n     * @param  {Boolean} debug    Enable debug mode\n     * @return {Storefront}        Instance\n     */\n    constructor(storeKey, config = {}, debug = false) {\n        this.version = config.version || 'v1';\n        this.options = {\n            version: this.version,\n            host: config.host || 'https://api.fleetbase.io',\n            namespace: `storefront/${this.version}` || config.namespace,\n            publicKey: storeKey,\n            debug,\n        };\n\n        if (!isKeyValid(storeKey)) {\n            throw new Error('⚠️ Invalid Storefront key given to Storefront SDK');\n        }\n\n        this.adapter = config.adapter || detectAdapter(this.options);\n\n        this.products = new StorefrontStore('product', this.adapter);\n        this.categories = new StorefrontStore('category', this.adapter);\n        this.reviews = new StorefrontStore('review', this.adapter).extendActions(reviewActions);\n        this.customers = new StorefrontStore('customer', this.adapter).extendActions(customerActions);\n        this.cart = new StorefrontStore('cart', this.adapter).extendActions(cartActions);\n        this.checkout = new StorefrontStore('checkout', this.adapter).extendActions(checkoutActions);\n    }\n\n    /** loads information about this storefront */\n    about() {\n        return this.adapter.get('about');\n    }\n\n    /** lookup a specific store or network provided the ID */\n    lookup(id) {\n        return this.adapter.get(`lookup/${id}`);\n    }\n\n    /** search products in store or network */\n    search(query, options = {}) {\n        return this.adapter.get('search', { query, ...options }).then((products) => {\n            return new Collection(products.map((product) => new Product(product)));\n        });\n    }\n\n    static newInstance() {\n        return new Storefront(...arguments);\n    }\n\n    setAdapter(adapter) {\n        this.adapter = adapter;\n    }\n\n    getAdapter() {\n        return this.adapter;\n    }\n}\n\nexport { Product, Category, Customer, Cart, Store, StoreLocation, StoreHour, DeliveryServiceQuote, Checkout, PaymentGateway, Review, Network, lookup };\n","const isKeyValid = (key) => {\n    return typeof key === 'string' && key.length > 30 && (key.startsWith('store_') || key.startsWith('network_'));\n};\n\nexport default isKeyValid;\n"],"names":["Network","attributes","arguments","length","undefined","adapter","options","_classCallCheck","_callSuper","_inherits","Resource","_createClass","key","value","params","this","get","_getResourceCollection","_asyncToGenerator","_regeneratorRuntime","mark","_callee","endpoint","ResourceClass","resources","_this","_args","wrap","_context","prev","next","sent","abrupt","Collection","map","t0","console","error","concat","stop","_x","_x2","apply","_getStores","_callee2","_args2","_context2","getResourceCollection","Store","_getStoreLocations","_callee3","_args3","_context3","StoreLocation","_getPaymentGateways","_callee4","_context4","PaymentGateway","Storefront","storeKey","config","debug","version","host","namespace","publicKey","startsWith","Error","isNodeEnvironment","lookup","detectAdapter","products","StorefrontStore","categories","reviews","extendActions","reviewActions","customers","customerActions","cart","cartActions","checkout","checkoutActions","id","query","_objectSpread","then","product","Product","_construct","Array","prototype","slice","call"],"mappings":"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"}